# ShopSystem - 面向对象网上购物模拟系统

## 项目概述
ShopSystem 是基于 C++20 和 SQLite3 开发的网上购物模拟系统，遵循面向对象设计思想与分层架构模式。该系统实现了从用户注册登录、商品浏览、购物车操作到订单管理、折扣活动设置的完整电商流程，支持普通用户与管理员双角色权限控制，所有数据通过 SQLite 实现持久化存储，确保信息不丢失。

## 技术栈
- **编程语言**：C++20（需编译器支持 GCC 10+、Clang 12+、MSVC 2019+）
- **数据库**：SQLite3（数据持久化存储）
- **界面**：TUI
- **开发工具**：CLion
- **运行环境**：Windows/Linux
- **构建工具**：CMake 3.30+

## 核心功能

### 1. 用户端功能
- 账号管理：注册、登录、密码修改，未注册用户登录时可直接跳转注册
- 商品浏览：分页展示、按名称/分类/价格多条件搜索，支持详情查看
- 购物车操作：添加商品、修改数量、删除商品（支持单删/多选删除/清空）
- 订单管理：创建订单、取消订单（仅准备发货状态）、更新收货地址、删除订单（仅已送达/已取消状态）
- 折扣享受：自动应用有效折扣（折扣券+满减叠加），过期折扣自动失效

### 2. 管理员功能
- 商品管理：添加、修改（名称/价格/库存等）、删除商品，查看全量商品详情
- 订单管理：查看所有用户订单，修改订单状态（准备发货/运输中/已送达等）
- 折扣管理：设置商品折扣（百分比折扣/满减/组合折扣）、删除折扣，查看所有折扣信息
- 权限控制：仅管理员账号（root）可访问管理功能模块

### 3. 数据持久化
所有核心数据均存储于 SQLite 数据库，包括账号信息、商品数据、购物车记录、订单详情、折扣规则，程序重启后数据不丢失。

## 系统架构与设计

### 分层架构
- **实体层**：封装核心业务对象（Account 账号、Item 商品、Cart 购物车、Order 订单）
- **服务层**：提供业务逻辑接口（Logio 登录服务、ItemService 商品服务）
- **持久层**：Database 类封装 SQLite 操作，实现数据增删改查
- **控制层**：菜单类（Menu 基类、MainMenu 主菜单、ShopMenu 商品菜单）提供交互界面

### 数据库设计
系统包含 6 张核心数据表，字段约束严格确保数据有效性：
- `account`：存储账号ID、用户名（唯一）、密码
- `items`：存储商品完整信息（名称、分类、价格、库存、状态等）
- `carts`：关联用户与商品，存储购物车商品数量
- `user_orders`：存储订单核心信息（总价、状态、用户ID、地址等）
- `order_items`：存储订单关联的商品明细
- `item_discount`：存储商品折扣规则（折扣比例、满减门槛、有效时间）

## 快速开始

### 编译运行
1. 安装依赖：CMake 3.30+、SQLite3 开发库
2. 克隆仓库并进入项目目录
3. 构建编译：
   ```bash
   mkdir build && cd build
   cmake ..
   make  # Linux环境，Windows使用对应构建工具（如MSBuild）
   ```
4. 运行生成的可执行文件，初始管理员账号：`root`，密码：`root`

### 基本操作流程
1. 普通用户：登录/注册 → 浏览/搜索商品 → 添加购物车/直接购买 → 填写地址创建订单 → 管理订单
2. 管理员：登录管理员账号 → 商品管理/订单管理/折扣设置 → 提交修改（自动同步至数据库）

## 核心特性说明
- **分层设计**：各模块解耦，便于功能扩展与维护
- **交互友好**：输入错误时提供明确提示，支持重复输入，分页浏览流畅
- **数据安全**：数据库字段添加约束（价格/库存非负、用户名唯一），避免无效数据
- **折扣计算**：支持百分比折扣与满减叠加，自动计算最优价格
- **订单状态流转**：支持自动状态切换（准备发货→运输中），状态变更符合实际业务逻辑

## 测试用例覆盖
- 输入验证：非法选项、空值输入、超出范围输入（如负价格/超库存购买）
- 功能验证：账号注册登录、商品增删改查、购物车操作、订单创建与状态变更、折扣生效与过期
- 边界测试：购物车商品数量为0、订单取消/删除的状态限制、折扣有效期临界值

## 项目结构
```
ShopSystem/
├── include/                # 所有头文件（类声明、结构体定义）
├── src/
│   └── module/
│       ├── Account/        # 账号相关（Account.cpp、Logio.cpp）
│       ├── Shop/           # 商品与购物车（Item.cpp、Cart.cpp）
│       ├── Menu/           # 菜单交互（Menu.cpp、MainMenu.cpp等）
│       ├── Data/           # 数据库操作（Database.cpp）
│       ├── Order/          # 订单相关（Order.cpp、OrderList.cpp）
│       └── Service/        # 业务服务（ItemService.cpp）
├── test/                   # 功能测试代码
├── CMakeLists.txt          # 构建配置文件
└── main.cpp                # 程序入口
```

## 注意事项
1. 数据库文件 `shop.db` 自动生成于编译目录，请勿手动删除或修改
2. 管理员账号仅初始账号 `root`，建议登录后及时修改密码
3. 商品库存为0时将不参与商品列表展示，需管理员补充库存后恢复
4. 折扣设置需指定有效时间，格式为 `YYYY-MM-DD HH:MM:SS`，过期折扣自动失效
5. 该README由AI生成
